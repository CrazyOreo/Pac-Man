#include <stdio.h>
#include <windows.h>
#include <stdbool.h>

#define W 30
#define H 17

int x = 5, y = 5, pts = 0, i, j;
char map[H][W] = {
    {'1','6','6','6','6','6','6','6','6','6','1','6','6','0','6','6','6','1','6','6','6','6','6','6','6','6','6','1'},
    {'1','0','0','0','0','0','0','0','0','0','1','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0','0','1'},
    {'1','0','6','6','0','1','0','6','6','0','6','0','6','6','6','6','0','6','0','6','6','0','1','0','6','6','0','1'},
    {'1','5','2','2','2','1','0','2','2','2','2','0','2','0','2','2','0','2','2','2','2','0','1','2','2','2','5','1'},
    {'1','6','6','0','6','6','0','6','6','6','1','0','6','6','6','6','0','1','6','6','6','0','6','6','0','6','6','1'},
    {'1','0','2','2','2','2','2','2','2','0','1','2','2','2','2','2','0','1','0','2','2','2','2','2','2','2','0','1'},
    {'1','0','6','6','0','1','0','6','6','0','6','0','6','6','6','6','0','6','0','6','6','0','1','0','6','6','0','1'},
    {'1','5','2','2','2','1','0','2','2','2','2','0','2','0','2','2','0','2','2','2','2','0','1','2','2','2','5','1'},
    {'1','6','6','6','6','6','6','6','6','6','1','6','6','0','6','6','6','1','6','6','6','6','6','6','6','6','6','1'},
    {'1','0','2','2','2','2','2','2','2','0','1','2','2','2','2','2','0','1','0','2','2','2','2','2','2','2','0','1'},
    {'1','0','6','6','0','1','0','6','6','0','6','0','6','6','6','6','0','6','0','6','6','0','1','0','6','6','0','1'},
    {'1','5','2','2','2','1','0','2','2','2','2','0','2','0','2','2','0','2','2','2','2','0','1','2','2','2','5','1'},
    {'1','6','6','0','6','6','0','6','6','6','1','0','6','6','6','6','0','1','6','6','6','0','6','6','0','6','6','1'},
    {'1','0','2','2','2','2','2','2','2','0','1','2','2','2','2','2','0','1','0','2','2','2','2','2','2','2','0','1'},
    {'1','0','6','6','0','1','0','6','6','0','6','0','6','6','6','6','0','6','0','6','6','0','1','0','6','6','0','1'},
    {'1','5','2','2','2','1','0','2','2','2','2','0','2','0','2','2','0','2','2','2','2','0','1','2','2','2','5','1'},
    {'6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6','6'}
};


void draw(int py, int px);
void control();

void control() {
    if (GetAsyncKeyState(VK_LEFT) && x > 0 && (map[y][x-1] == '0' || map[y][x-1] == '2' || map[y][x-1] == '5'))
        draw(0, -1); // Para Esquerda
    else if (GetAsyncKeyState(VK_UP) && y > 3 && (map[y-1][x] == '0' || map[y-1][x] == '2' || map[y-1][x] == '5'))
        draw(-1, 0); // Para Cima
    else if (GetAsyncKeyState(VK_RIGHT) && x < W-1 && (map[y][x+1] == '0' || map[y][x+1] == '2' || map[y][x+1] == '5'))
        draw(0, 1); // Para Direita
    else if (GetAsyncKeyState(VK_DOWN) && y < H-1 && (map[y+1][x] == '0' || map[y+1][x] == '2' || map[y+1][x] == '5'))
        draw(1, 0); // Para Baixo
    else if (GetAsyncKeyState(VK_ESCAPE))
        exit(0); // ESC para sair
}

// Função principal
int main() {
    draw(0,0);
    while(true) {
        control();
        Sleep(100);
    }
    return 0;
}

// Esta função é usada para transformar os chars em itens da tabela ASCII
void draw(int py, int px) {
    if(pts==165){
            system ("cls");
        printf ("\n\nFim de jogo!");
    return 0;
    }
    if(map[y+py][x+px] == '2') pts++;
    if(map[y+py][x+px] == '5') pts += 5 ;
    map[y][x] = '0';
    x += px;
    y += py;
    map[y][x] = '4';
    system("cls");
    system("color 16");

        for ( i = 0; i < H; i++) {
        for ( j = 0; j < W; j++) {
        switch(map[i][j]) {
                case '0': printf(" "); break;            // Buraco
                case '1': printf("%c", 219); break;     // Parede Vertical
                case '2': printf("%c", 45); break;      // Pontos
                case '3': printf("%c", 248); break;     // Simbolo
                case '4': printf("%c", 67); break;      // Personagem
                case '5': printf("%c", 178); break;     // Caixinha
                case '6': printf("%c", 223); break;     // Parede Horizontal
            }
        }
        printf("\n");
    }
    printf("\nSeus Pontos:              %i\n", pts);
    printf("Integrantes:\n");
    printf("Pedro Henrique Macegosa Novais\n");
    printf("Jefferson\n");
    printf("Tiago\n");
    printf("Victor Hugo\n");
    getch();
}
